
\section{Recomposition}

$\boxed{\recompPlus{\Grove} = G}$
%
\begin{align*}
  \recompPlus{(MP, NP, U)} &= \SetOf{\e \mapsto \Plus \SuchThat{\e \in \bigcup_{e \in MP \cup NP \cup U} \erecomp{e}}}
\end{align*}

\noindent $\boxed{\erecomp{e} \subset \E}$
%
\begin{align*}
  \erecomp{\varExp{x}{u}} &= \{\}
  \\
  \erecomp{\numExp{n}{u}} &= \{\}
  \\
  \erecomp{\appExp{e_\AppFun}{e_\AppArg}{u}}
  &= \erecomp{e_\AppFun}
  \cup \erecomp{e_\AppArg} \\
  &\cup \erecompPrime{v}{\AppFun}{e_\AppFun}
  \cup \erecompPrime{v}{\AppArg}{e_\AppArg} \\
  &\quad\text{where } v = (u, \ExpApp)
  \\
  \erecomp{\plusExp{e_\PlusLeft}{u}{e_\PlusRight}}
  &= \erecomp{e_\PlusLeft}
  \cup \erecomp{e_\PlusRight} \\
  &\cup \erecompPrime{v}{\PlusLeft}{e_\PlusLeft}
  \cup \erecompPrime{v}{\PlusRight}{e_\PlusRight} \\
  &\quad\text{where } v = (u, \ExpPlus)
  \\
  \erecomp{\lamExp{u}{q_\LamParam}{\tau_\LamType}{e_\LamBody}}
  &= \precomp{q_\LamParam}
  \cup \trecomp{\tau_\LamType}
  \cup \erecomp{e_\LamBody} \\
  &\cup \precompPrime{v}{\LamParam}{q_\LamParam}
  \cup \trecompPrime{v}{\LamType}{\tau_\LamType} \\
  &\cup \erecompPrime{v}{\LamBody}{e_\LamBody} \\
  &\quad\text{where } v = (u, \ExpLam)
  \\
  \erecomp{\hole} &= \{\}
  \\
  \erecomp{\conflictHole{e_1, \cdots, e_n}}
  &= \bigcup_{k=1}^n \erecomp{e_k}
  \\
  \erecomp{\multiVertex{v}} &= \{\}
  \\
  \erecomp{\cycleVertex{v}} &= \{\}
\end{align*}
%
% \vskip\baselineskip
$\boxed{\erecompPrime{v}{p}{e} \subseteq \E}$
%
\begin{align*}
  \erecompPrime{v}{p}{\varExp{x}{u}}
  &= \{(u', v, p, (u, \ExpVar(x)))\}
  \\
  \erecompPrime{v}{p}{\numExp{n}{u}}
  &= \{(u', v, p, (u, \ExpNum(n)))\}
  \\
  \erecompPrime{v}{p}{\appExp{e_\AppFun}{e_\AppArg}{u}}
  &= \{(u', v, p, (u, \ExpApp))\}
  \\
  \erecompPrime{v}{p}{\plusExp{e_\PlusLeft}{u} {e_\PlusRight}}
  &= \{(u', v, p, (u, \ExpPlus))\}
  \\
  \erecompPrime{v}{p}{\lamExp{u}{q_\LamParam}{\tau_\LamType}{e_\LamBody}}
  &= \{(u', v, p, (u, \ExpLam))\}
  \\
  \erecompPrime{v}{p}{\hole} &= \{\}
  \\
  \erecompPrime{v}{p}{\conflictHole{e_1, \cdots, e_n}}
  &= \bigcup_{i=1}^n \erecompPrime{v}{p}{e_i}
  \\
  \erecompPrime{v}{p}{\multiVertex{v'}}
  &= \{(u', v, p, v')\}
  \\
  \erecompPrime{v}{p}{\cycleVertex{v'}}
  &= \{(u', v, p, v')\}
\end{align*}
%
% \vskip\baselineskip
$\boxed{\precomp{q} \subset \E}$
%
\begin{align*}
  \precomp{\varPat{x}{u}} &= \{\}
  \\
  \precomp{\hole} &= \{\}
  \\
  \precomp{\conflictHole{q_1, \cdots, q_n}}
  &= \bigcup_{i=1}^n \precomp{q_i}
  \\
  \precomp{\multiVertex{v}} &= \{\}
  \\
  \precomp{\cycleVertex{v}} &= \{\}
\end{align*}
%
% \vskip\baselineskip
$\boxed{\precompPrime{v}{p}{q} \subset \E}$
%
\begin{align*}
  \precompPrime{v}{p}{\varPat{x}{u}}
  &= \{(u', v, p, (u, \PatVar(x)))\}
  \\
  \precompPrime{v}{p}{\hole} &= \{\}
  \\
  \precompPrime{v}{p}{\conflictHole{e_1, \cdots, e_n}}
  &= \bigcup_{i=1}^n \precompPrime{v}{p}{e_i}
  \\
  \precompPrime{v}{p}{\multiVertex{v'}}
  &= \{(u', v, p, v')\}
  \\
  \precompPrime{v}{p}{\cycleVertex{v'}}
  &= \{(u', v, p, v')\}
\end{align*}
%
% \vskip\baselineskip
$\boxed{\trecomp{\tau} \subset \E}$
%
\begin{align*}
  \trecomp{\arrowTyp{\tau_\ArrowArg}{u}{\tau_\ArrowResult}}
  &= \trecomp{\tau_\ArrowArg}
  \cup \trecomp{\tau_\ArrowResult} \\
  &\cup \trecompPrime{v}{\ArrowArg}{\tau_\ArrowArg}
  \cup \trecompPrime{v}{\ArrowResult}{\tau_\ArrowResult} \\
  &\quad\text{where } v = (u, \TypArrow)
  \\
  \trecomp{\numTyp{u}} &= \{\}
  \\
  \trecomp{\hole} &= \{\}
  \\
  \trecomp{\conflictHole{\tau_1, \cdots, \tau_n}}
  &= \bigcup_{i=1}^n \trecomp{\tau_i}
  \\
  \trecomp{\multiVertex{u}} &= \{\}
  \\
  \trecomp{\cycleVertex{u}} &= \{\}
\end{align*}
%
% \vskip\baselineskip
$\boxed{\trecompPrime{v}{p}{\tau} \subset \E}$
%
\begin{align*}
  \trecompPrime{v}{p}{\arrowTyp{\tau_\ArrowArg}{u}{\tau_\ArrowResult}}
  &= \{(u', v, p, (u, \TypArrow)))\}
  \\
  \trecompPrime{v}{p}{\numTyp{u}}
  &= \{(u', v, p, (u, \TypNum)))\}
  \\
  \trecompPrime{v}{p}{\hole} &= \{\}
  \\
  \trecompPrime{v}{p}{\conflictHole{\tau_1, \cdots, \tau_n}}
  &= \bigcup_{i=1}^n \trecompPrime{v}{p}{\tau_i}
  \\
  \trecompPrime{v}{p}{\multiVertex{v'}}
  &= \{(u', v, p, v')\}
  \\
  \trecompPrime{v}{p}{\cycleVertex{v'}}
  &= \{(u', v, p, v')\}
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \section{Theorems}

% \begin{definition}
%   A graph $G$ is well sorted if
%   $(p, \sort(k_2)) \in \arity(k_1)$
%   for all $\e = (u, (u_1, k_1), p, (u_2, k_2))$ such that $G(\e) \neq \bot$.
% \end{definition}

% \begin{theorem}[exhaustiveness check]
%   If a graph $G$ is well-sorted,
%   then there exists a grove $\Grove$
%   such that $\decomp(G) = \Grove$.
% \end{theorem}

% \begin{theorem}[every vertex is part of decomposition]
%   For any well-sorted graph $G$,
%   if $\decomp(G) = \Grove$,
%   then $\vertexes(G) = \vertexes(\Grove)$.
% \end{theorem}

% \begin{theorem}[relationship between decomp and recomp]
%   For any well-sorted graph $G$,
%   if $\decomp(G) = \Grove$,
%   then $\recomp(\Grove) = G$.
% \end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \end{document}