%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Language Components

\usepackage{xstring}
\usepackage{tensor}

% \selectcolormodel{gray}

% notation
\def\_{\texttt{\textunderscore}}
\newcommand{\id}[1]{\textcolor{gray}{\ensuremath{#1}}}
\newcommand{\preid}[2]{\tensor*[_{\id{#1}}]{#2}{}}
\newcommand{\abs}[1]{\left\lvert#1\right\rvert}
\newcommand{\figureCode}[1]{\textbf{\texttt{#1}}\vskip1em}
\newcommand{\SetOf}[1]{\left\{#1\right\}}
\newcommand{\SuchThat}[1]{ : #1}

% sets
\def\A{\mathcal{A}}
\def\E{\mathcal{E}}
\def\G{\mathcal{G}}
\def\I{\mathcal{I}}
\def\K{\mathcal{K}}
\def\P{\mathcal{P}}
\def\S{\mathcal{S}}
\def\U{\mathcal{U}}
\def\V{\mathcal{V}}
\def\e{\varepsilon}
\def\AA{\textbf{A}}
\def\EE{\textbf{E}}

% Sorts
\newcommand\Exp{\mathsf{Exp}}
\newcommand\Pat{\mathsf{Pat}}
\newcommand\Typ{\mathsf{Typ}}

% objects
\def\e{\varepsilon}
\def\Grove{\gamma}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Graphs

\newcommand{\Edge}[1]{Edge~#1}
\newcommand{\Vertex}[1]{Vertex~#1}
\newcommand{\multiVertex}[1]{\textcolor{red}{\ensuremath{\curlyveedownarrow_{#1}}}}
\newcommand{\cycleVertex}[1]{\textcolor{red}{\ensuremath{\rcirclearrowleft_{#1}}}}
\newcommand{\orphanVertex}[1]{\textcolor{red}{\ensuremath{\mathbf{\ndownarrow_{#1}}}}}
\newcommand{\parens}[1]{\textcolor{gray}{(}#1\textcolor{gray}{)}}
\newcommand{\otherVertexVskip}{\vskip0.5em}

% Constructors
\newcommand\ExpVar{\mathsf{Exp\_var}}
\newcommand\ExpLam{\mathsf{Exp\_lam}}
\newcommand\ExpApp{\mathsf{Exp\_app}}
\newcommand\ExpNum{\mathsf{Exp\_num}}
\newcommand\ExpPlus{\mathsf{Exp\_plus}}
\newcommand\ExpTimes{\mathsf{Exp\_times}}
\newcommand\PatVar{\mathsf{Pat\_var}}
\newcommand\TypNum{\mathsf{Typ\_num}}
\newcommand\TypArrow{\mathsf{Typ\_arrow}}

% Positions
\newcommand\Root{\mathsf{Root}}
\newcommand\LamParam{\mathsf{Param}}
\newcommand\LamType{\mathsf{Type}}
\newcommand\LamBody{\mathsf{Body}}
\newcommand\AppFun{\mathsf{Fun}}
\newcommand\AppArg{\mathsf{Arg}}
\newcommand\PlusLeft{\mathsf{Left}}
\newcommand\PlusRight{\mathsf{Right}}
\newcommand\TimesLeft{\mathsf{Left}}
\newcommand\TimesRight{\mathsf{Right}}
\newcommand\ArrowArg{\mathsf{Arg}}
\newcommand\ArrowResult{\mathsf{Result}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Terms

\newcommand{\varExp}[2]{#1^{#2}}
\newcommand{\numExp}[2]{\underline{#1}^{#2}}
\newcommand{\lamExp}[4]{\lambda^{#1} #2 : #3.#4}
\newcommand{\appExp}[3]{\left(#1~#2\right)^{#3}}
\newcommand{\plusExp}[3]{#1 +^{#2} #3}
\newcommand{\varPat}[2]{#1^{#2}}
\newcommand{\arrowTyp}[3]{#1 \to^{#2} #3}
\newcommand{\numTyp}[1]{Num^{#1}}
\newcommand{\hole}{\ensuremath{\square}} %\textcolor{violet}{\llparenthesis}}\textcolor{violet}{\rrparenthesis}}
\newcommand{\conflictHole}[1]{%
{\noexpandarg\StrSubstitute{#1}{,}{\textcolor{red}{\;\textbf{|}\;}}[\myargs]%
{\textcolor{red}{\textbf{\{}}\myargs\textcolor{red}{\textbf{\}}}}}}%

\newcommand{\eFun}[7]{\lambda^{\id{#1}}\!\!\!\!\preid{#2}{#3}\mathord{:}\preid{#4}{#5}.\preid{#6}{#7}}
\newcommand{\eApp}[5]{\preid{#1}{#2}^{\id{#3}}\!\!\!\!\preid{#4}{#5}}
\newcommand{\ePlus}[5]{\preid{#1}{#2}~\texttt{+}^{\id{#3}}\!\!\!\!\preid{#4}{#5}}
\newcommand{\eTimes}[5]{\preid{#1}{#2}~\texttt{*}^{\id{#3}}\!\!\!\!\preid{#4}{#5}}
\newcommand{\tArrow}[5]{\preid{#1}{#2}\rightarrow^{\id{#3}}\!\!\!\!\!\preid{#4}{#5}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Decomposition

\DeclareMathOperator{\decompOp}{\texttt{decomp}}
\DeclareMathOperator{\vertexesOp}{\texttt{vertexes}}
\newcommand{\decomp}[1]{\decompOp\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\vertexes}[1]{\vertexesOp\mathopen{}\left(#1\right)\mathclose{}}

\DeclareMathOperator{\edecompOp}{\texttt{edecomp}}
\DeclareMathOperator{\pdecompOp}{\texttt{pdecomp}}
\DeclareMathOperator{\tdecompOp}{\texttt{tdecomp}}
\DeclareMathOperator{\edecompPrimeOp}{\edecompOp^\prime}
\DeclareMathOperator{\pdecompPrimeOp}{\pdecompOp^\prime}
\DeclareMathOperator{\tdecompPrimeOp}{\tdecompOp^\prime}
\newcommand{\edecomp}[1]{\edecompOp\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\pdecomp}[1]{\pdecompOp\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\tdecomp}[1]{\tdecompOp\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\edecompPrime}[2]{\edecompPrimeOp\mathopen{}\left(#1, #2\right)\mathclose{}}
\newcommand{\pdecompPrime}[2]{\pdecompPrimeOp\mathopen{}\left(#1, #2\right)\mathclose{}}
\newcommand{\tdecompPrime}[2]{\tdecompPrimeOp\mathopen{}\left(#1, #2\right)\mathclose{}}

% helpers
\DeclareMathOperator{\parents}{\text{parents}}
\DeclareMathOperator{\ancestors}{\text{ancestors}}
\DeclareMathOperator{\vertices}{\text{vertices}}
\DeclareMathOperator{\children}{\text{children}}
\DeclareMathOperator{\lfp}{\text{lfp}}

\DeclareMathOperator{\minOp}{\text{min}}
\renewcommand{\min}[1]{\minOp\mathopen{}\left(#1\right)\mathclose{}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Recomposition

\DeclareMathOperator{\recompPlusOp}{\texttt{recomp}^{+}}
\newcommand{\recompPlus}[1]{\recompPlusOp\mathopen{}\left(#1\right)\mathclose{}}

\DeclareMathOperator{\recompOp}{\texttt{recomp}}
\DeclareMathOperator{\erecompOp}{\texttt{erecomp}}
\DeclareMathOperator{\precompOp}{\texttt{precomp}}
\DeclareMathOperator{\trecompOp}{\texttt{trecomp}}
\DeclareMathOperator{\erecompPrimeOp}{\erecompOp^\prime}
\DeclareMathOperator{\precompPrimeOp}{\precompOp^\prime}
\DeclareMathOperator{\trecompPrimeOp}{\trecompOp^\prime}
\newcommand{\recomp}[2]{\recompOp\mathopen{}\left(#1, #2\right)\mathclose{}}
\newcommand{\erecomp}[1]{\erecompOp\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\precomp}[1]{\precompOp\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\trecomp}[1]{\trecompOp\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\erecompPrime}[3]{\erecompPrimeOp\mathopen{}\left(#1, #2, #3\right)\mathclose{}}
\newcommand{\precompPrime}[3]{\precompPrimeOp\mathopen{}\left(#1, #2, #3\right)\mathclose{}}
\newcommand{\trecompPrime}[3]{\trecompPrimeOp\mathopen{}\left(#1, #2, #3\right)\mathclose{}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% actions
% \def\Create{\text{Create}}
% \def\Destroy{\text{Destroy}}
\def\Down{\text{Down}}
\def\Enqueue{\text{Enqueue}}
\def\Left{\text{Left}}
\def\Move{\text{Move}}
\def\Num{\text{Num}}
% \def\Restore{\text{Restore}}
\def\Right{\text{Right}}
\def\Select{\text{Select}}
\def\Send{\text{Send}}
\def\Up{\text{Up}}

\newcommand\Delete{\mathrm{Delete}}
\newcommand{\Create}[1]{\mathrm{Create}\mathopen{}\left(#1\right)\mathclose{}}
% \newcommand{\Drop}[1]{\mathrm{Drop}\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\Restore}[1]{\mathrm{Restore}\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\Wrap}[1]{\mathrm{Wrap}\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\Reposition}[1]{\mathrm{Reposition}\mathopen{}\left(#1\right)\mathclose{}}

% \Create{k} \mid \Delete \mid \Drop{\e} \mid \Restore{v}

% relations
\DeclareMathOperator{\sort}{\text{sort}}
\DeclareMathOperator{\arity}{\text{arity}}
